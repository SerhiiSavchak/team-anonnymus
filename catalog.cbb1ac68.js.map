{"mappings":"oeAAAA,EAAA,S,sBCAA,IAAAC,EAAAD,EAAA,SAEA,MAIME,EAAU,CACdC,OAAQ,MACRC,QAAS,CACPC,OAAQ,mBACRC,cACE,+NAKAC,EAAQC,SAASC,cAAc,iBAC/BC,EAAaF,SAASC,cAAc,gBACpCE,EAAcH,SAASC,cAAc,sBACrCG,EAAiBJ,SAASC,cAAc,oBACxCI,EAAWL,SAASC,cAAc,cAsExCK,eAAeC,EAAUC,EAAUC,GACjC,IACE,MAAMC,QAAiBC,MAAM,gCAAcH,IAAYC,GAEvD,aADmBC,EAASE,QAChBC,QAAQC,MAAM,EAAG,G,CAC7B,MAAOC,GAEP,OADAC,QAAQC,IAAIF,GACJX,EAAec,UAAY,gI,EAgBvC,SAASC,EAAaC,GACpB,OAXFd,eAA2Be,GACzB,MAAMX,QAAiBC,MACrB,4DACAU,GAGF,aADmBX,EAASE,QAChBU,M,CAKLC,CAAY7B,GAAS8B,MAAKC,IAC/B,MAAMC,EAqCV,SAAuBN,EAAWK,GAiBhC,OAhB0BL,EAAUO,KAAIC,IACtC,MACMN,EADWM,EAAMC,UACCF,KACtBG,GAAML,EAAUM,MAAKC,GAASA,EAAMF,KAAOA,IAAIG,OAGjD,MAAO,CACLC,aAAcN,EAAMM,aACpBJ,GAAIF,EAAME,GACVK,MAAOP,EAAMO,MACbC,OAAQR,EAAMS,YACdC,WAAYhB,EAAO,GACnBiB,YAAajB,EAAO,GACrB,G,CAnDuBkB,CAAcpB,EAAWK,GAEjD,OAAsBC,EAMrBC,KACCC,GAAS,gBAAgBA,EAAME,8JAGvBF,EAAMQ,gBACER,EAAMO,gHAE0BP,EAAME,OACpDF,EAAMO,iEAEuCP,EAAME,0BACzCF,EAAMU,eAAeV,EAAMW,kDACZX,EAAME,sDACjBF,EAAMM,aAAapB,MAAM,EAAG,2GAO7C2B,KAAK,GA1BgC,G,CA8B1C,SAASC,EAAUC,EAASC,GAC1BD,EAAQzB,UAAY0B,C,CA7HtBC,OAAOC,iBAAiB,QAKxB,WAEE,IAAIC,EAGFA,EAJkBF,OAAOG,YAGR,IACP,GAEA,GAKZzC,EAFiB,8FAA8FwC,IAE3FrD,GAAS8B,MAAKd,IAChCS,EAAaT,EAASI,MAAM,EAAGiC,IAAUvB,MAAKoB,IAC5CF,EAAU3C,EAAO6C,GACjB7C,EAAM+C,iBAAiB,QAASrD,EAAAwD,YAAY,GAC5C,G,IApBN/C,EAAW4C,iBAAiB,UAyB5B,SAAwBI,GACtBA,EAAMC,iBACN,MAAMC,EAAcjD,EAAYkD,MAAMC,OAEtC,IAAIP,EAGFA,EADEF,OAAOG,YAAc,IACb,GAEA,GAGZ,GAAoB,KAAhBI,EAAoB,CAGtB7C,EAFuB,sBAAsB6C,wDAAkEL,IAErFrD,GAAS8B,MAAKd,IACd,IAApBA,EAAS6C,OACXpC,EAAaT,EAASI,MAAM,EAAGiC,IAAUvB,MAAKoB,IAC5CF,EAAU3C,EAAO6C,EAAO,IAG1BxC,EAAec,UAAY,oI,QA7CnCb,EAASyC,iBAAiB,SAoD1B,SAAyBU,GACvBrD,EAAYkD,MAAQ,E,IA9BtBlD,EAAY2C,iBAAiB,SAiC7B,SAAwBU,GACtB,GAAgC,IAA5BA,EAAIC,OAAOJ,MAAME,OAEnB,YADAlD,EAASqD,MAAMC,QAAU,QAG3BtD,EAASqD,MAAMC,QAAU,O","sources":["src/catalog.js","src/js/components/catalog-list.js"],"sourcesContent":["import './js/utils/theme';\nimport './js/components/header';\nimport './js/components/hero';\nimport './js/components/catalog-list';\nimport './js/components/modal';\n\nimport './js/components/footer';\nimport './js/utils/scroll-up';\nimport './js/utils/loader';\n","import { selectMovie } from './modal';\n\nconst BASE_URL = 'https://api.themoviedb.org/3/';\nconst END_POINT =\n  'trending/movie/week?language=en-US&include_adult=false&include_video=false&page=1&per_page=10';\nconst STORAGE_KEY = 'ID';\nconst options = {\n  method: 'GET',\n  headers: {\n    accept: 'application/json',\n    Authorization:\n      'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJiZDBhNDQ5OWUzZjBiMDM2MDI1ZDEyNTk1Mzk3MjI3YSIsInN1YiI6IjY0N2YxZDM3Y2FlZjJkMDEzNjJjZDBjMyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.04GEOyHwNXnOZB4gUWNaiyPlLlOZ0z9Ttfl7T5UFMuk',\n  },\n};\n\n// REFS\nconst ulRef = document.querySelector('.catalog-list');\nconst searchForm = document.querySelector('.search-form');\nconst searchInput = document.querySelector('.search-form-input');\nconst errorContainer = document.querySelector('.error-container');\nconst btnClear = document.querySelector('.btn-clear');\n\n// WORKSPACE\nwindow.addEventListener('load', onPageLoad);\nsearchForm.addEventListener('submit', onSearchSubmit);\nbtnClear.addEventListener('click', onBtnClearClick);\n\n// LISTENER\nfunction onPageLoad() {\n  const screenWidth = window.innerWidth;\n  let perPage;\n\n  if (screenWidth >= 768) {\n    perPage = 20;\n  } else {\n    perPage = 10;\n  }\n\n  const endpoint = `trending/movie/week?language=en-US&include_adult=false&include_video=false&page=1&per_page=${perPage}`;\n\n  fetchData(endpoint, options).then(response => {\n    renderMarkup(response.slice(0, perPage)).then(markup => {\n      addMarkup(ulRef, markup);\n      ulRef.addEventListener('click', selectMovie);\n    });\n  });\n}\n\nsearchInput.addEventListener('input', onCatalogInput);\nfunction onSearchSubmit(event) {\n  event.preventDefault();\n  const searchValue = searchInput.value.trim();\n\n  let perPage;\n\n  if (window.innerWidth >= 768) {\n    perPage = 20;\n  } else {\n    perPage = 10;\n  }\n\n  if (searchValue !== '') {\n    const searchEndpoint = `search/movie?query=${searchValue}&include_adult=false&language=en-US&page=1&per_page=${perPage}`;\n\n    fetchData(searchEndpoint, options).then(response => {\n      if (response.length !== 0) {\n        renderMarkup(response.slice(0, perPage)).then(markup => {\n          addMarkup(ulRef, markup);\n        });\n      } else\n        errorContainer.innerHTML = `<p class=\"catalog-error-text\">OOPS...<br>\n      We are very sorry!<br>\n      We don’t have any results matching your search.</p>`;\n    });\n  }\n}\n\nfunction onBtnClearClick(evt) {\n  searchInput.value = '';\n}\n\nfunction onCatalogInput(evt) {\n  if (evt.target.value.length === 0) {\n    btnClear.style.display = 'none';\n    return;\n  }\n  btnClear.style.display = 'block';\n}\n\n// FETCH\nasync function fetchData(endpoint, options) {\n  try {\n    const response = await fetch(`${BASE_URL}${endpoint}`, options);\n    const data = await response.json();\n    return data.results.slice(0, 20);\n  } catch (error) {\n    console.log(error);\n    return (errorContainer.innerHTML = `<p class=\"catalog-error-text\">OOPS...<br>\n    We are very sorry!<br>\n    We don’t have any results matching your search.</p>`);\n  }\n}\n\nasync function fetchGenres(options) {\n  const response = await fetch(\n    'https://api.themoviedb.org/3/genre/movie/list?language=en',\n    options\n  );\n  const data = await response.json();\n  return data.genres;\n}\n\n// MARKUP\nfunction renderMarkup(movieData) {\n  return fetchGenres(options).then(genreData => {\n    const transformedData = transformData(movieData, genreData);\n\n    return generateMarkup(transformedData);\n  });\n}\n\nfunction generateMarkup(movie) {\n  const markup = movie\n    .map(\n      movie => `<li data-id=\"${movie.id}\" class=\"catalog-movie\">\n        <div class=\"catalog-item-link\" href=\"\">\n            <img class=\"catalog-list-img\" src=\"https://image.tmdb.org/t/p/w500${\n              movie.poster\n            }\" alt=\"${movie.title}\" />\n            <div class=\"catalog-movie-desc\">\n            <p  class=\"catalog-item-title\" data-id=\"${movie.id}\">${\n        movie.title\n      }</p>\n            <p class=\"catalog-item-movie\" data-id=\"${movie.id}\" >\n                ${movie.genreFirst}, ${movie.genreSecond} | \n                <span data-id=\"${movie.id} class=\"catalog-item-date\">\n                    ${movie.release_date.slice(0, 4)}\n                </span> \n            </p>\n            </div>\n            </div> \n        </li>`\n    )\n    .join('');\n  return markup;\n}\n\nfunction addMarkup(element, markup) {\n  element.innerHTML = markup;\n}\n\n// UTILS\nfunction transformData(movieData, genreData) {\n  const transformedMovies = movieData.map(movie => {\n    const genreIds = movie.genre_ids;\n    const genres = genreIds.map(\n      id => genreData.find(genre => genre.id === id).name\n    );\n\n    return {\n      release_date: movie.release_date,\n      id: movie.id,\n      title: movie.title,\n      poster: movie.poster_path,\n      genreFirst: genres[0],\n      genreSecond: genres[1],\n    };\n  });\n\n  return transformedMovies;\n}\n"],"names":["parcelRequire","$8IXMh","$3a6e9223bb64b17e$var$options","method","headers","accept","Authorization","$3a6e9223bb64b17e$var$ulRef","document","querySelector","$3a6e9223bb64b17e$var$searchForm","$3a6e9223bb64b17e$var$searchInput","$3a6e9223bb64b17e$var$errorContainer","$3a6e9223bb64b17e$var$btnClear","async","$3a6e9223bb64b17e$var$fetchData","endpoint","options1","response","fetch","json","results","slice","error","console","log","innerHTML","$3a6e9223bb64b17e$var$renderMarkup","movieData","options2","genres","$3a6e9223bb64b17e$var$fetchGenres","then","genreData","transformedData","map","movie","genre_ids","id","find","genre","name","release_date","title","poster","poster_path","genreFirst","genreSecond","$3a6e9223bb64b17e$var$transformData","join","$3a6e9223bb64b17e$var$addMarkup","element","markup","window","addEventListener","perPage","innerWidth","selectMovie","event","preventDefault","searchValue","value","trim","length","evt","target","style","display"],"version":3,"file":"catalog.cbb1ac68.js.map"}